var app=angular.module("de.cismet.uim2020-html5-demonstrator",["de.cismet.uim2020-html5-demonstrator.controllers","de.cismet.uim2020-html5-demonstrator.directives","de.cismet.uim2020-html5-demonstrator.services","de.cismet.uim2020-html5-demonstrator.filters","ngResource","ngAnimate","ngSanitize","ui.bootstrap","ui.bootstrap.modal","ui.router","ui.router.modal","ct.ui.router.extras.sticky","ct.ui.router.extras.dsr","ct.ui.router.extras.previous","leaflet-directive","ngTable","angularjs-dropdown-multiselect","mgo-angular-wizard"]);app.config(["$logProvider","$stateProvider","$urlRouterProvider",function(a,b,c){"use strict";a.debugEnabled(!1);var d;d=function(a){return console.log("resolve entity "+a.id+"@"+a["class"]),{"class":a["class"],id:a.id}},c.otherwise("/search/map"),b.state("main",{"abstract":!0,sticky:!0,url:"",views:{main:{templateUrl:"views/main.html",controller:"mainController",controllerAs:"mainController"}},deepStateRedirect:{"default":{state:"main.search"}}}),b.state("main.authentication",{url:"login",data:{roles:["User"]},views:{"authentication@main":{templateUrl:"views/authentication/login.html",controller:"authenticationController",controllerAs:"authenticationController"}}}),b.state("main.search",{url:"/search",data:{roles:["User"]},sticky:!0,deepStateRedirect:{"default":{state:"main.search.map",params:{zoom:"15"}}},views:{"search@main":{templateUrl:"views/search/index.html",controller:"searchController",controllerAs:"searchController"},"search-toolbar@main.search":{templateUrl:"views/search/toolbar.html",controller:["$scope",function(a){console.log("main.search.toolbar instance created"),a.name="main.search.toolbar",this.name="this.main.search.toolbar"}],controllerAs:"toolbarController"}}}),b.state("main.search.map",{url:"/map?{center:int}&{zoom:int}",data:{roles:["User"]},sticky:!0,views:{"search-map@main.search":{templateUrl:"views/shared/map.html",controller:"mapController",controllerAs:"mapController"}}}),b.state("main.search.list",{url:"/list",data:{roles:["User"]},sticky:!0,views:{"search-list@main.search":{templateUrl:"views/search/list.html",controller:"listController",controllerAs:"listController"}}}),b.state("main.analysis",{url:"/analysis",data:{roles:["User"]},sticky:!0,deepStateRedirect:{"default":{state:"main.analysis.map",params:{zoom:"14"}}},views:{"analysis@main":{templateUrl:"views/analysis/index.html",controller:"analysisController",controllerAs:"analysisController"},"analysis-toolbar@main.analysis":{templateUrl:"views/analysis/toolbar.html",controller:["$scope",function(a){console.log("main.analysis.toolbar instance created"),a.name="main.analysis.toolbar",this.name="this.main.analysis.toolbar"}],controllerAs:"toolbarController"}}}),b.state("main.analysis.map",{url:"/map?{center:int}&{zoom:int}",data:{roles:["User"]},views:{"analysis-map@main.analysis":{templateUrl:"views/shared/map.html",controller:"mapController",controllerAs:"mapController"}},onEnter:function(){},onExit:function(){}}),b.state("main.protocol",{url:"/protocol",data:{roles:["User"]},sticky:!0,deepStateRedirect:!0,templateUrl:"views/protocol/index.html",controller:["$scope",function(a){console.log("main.protocol created"),a.name="main.protocol",this.name="this.main.protocol"}],controllerAs:"protocolController",views:{"protocol@main":{templateUrl:"views/protocol/index.html"}}}),b.state("modal",{"abstract":!0}),b.state("modal.entity",{url:"/entity/{class:string}/{id:int}",data:{roles:["User"]},sticky:!1,backdrop:"static",templateUrl:"views/entity/modal.html",controller:"entityController",controllerAs:"entityController",modal:!0,resolve:{entity:["$stateParams",d],entityModalInvoker:["$previousState",function(a){return a.memo("entityModalInvoker"),a.get("entityModalInvoker")}]}})}]),app.run(["$rootScope","$state","$stateParams","$previousState","authenticationService",function(a,b,c,d,e){"use strict";a.$state=b,a.$stateParams=c,a.$on("$stateChangeStart",function(a,c,f,g,h){"main.authentication"!==c.name?(e.isIdentityResolved()||e.getIdentity())&&e.isAuthenticated()?""===g.name&&"modal"===c.name.split(".").slice(0,1).pop()&&(a.preventDefault(),b.go("main.search.map",void 0,{location:!1}).then(function(){b.go(c,f)})):(console.warn("user not logged in!"),a.preventDefault(),d.memo("authentication"),b.go("main.authentication")):d.memo("authentication")})}]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers",[]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers").controller("analysisController",["$timeout","$scope","$state","leafletData",function(a,b,c,d){"use strict";var e;e=this,console.log("analysisController instance created"),e.mode="map",b.$on("$stateChangeSuccess",function(f){c.includes("main.analysis")&&!c.is("main.analysis")&&(e.mode=c.current.name.split(".").slice(1,3).pop(),console.log("analysisController::mode: "+e.mode),"map"===e.mode&&d.getMap("analysis-map").then(function(c){a(function(){c&&c._container.parentElement&&(c._container.parentElement.offsetHeight>0&&c._container.parentElement.offsetWidth>0?(b.mapHeight=c._container.parentElement.offsetHeight,b.mapWidth=c._container.parentElement.offsetWidth,console.log("analysisController::stateChangeSuccess new size: "+c._container.parentElement.offsetWidth+"x"+c._container.parentElement.offsetHeight),c.invalidateSize(!1)):(console.warn("analysisController::stateChangeSuccess saved size: "+b.mapWidth+"x"+b.mapHeight),c.invalidateSize(!1)))},100)}))})}]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers").controller("appController",["$scope","$state","$previousState","configurationService","sharedDatamodel","authenticationService",function(a,b,c,d,e,f){"use strict";var g;g=this,g.selectedSearchThemes=e.selectedSearchThemes,g.selectedSearchPollutants=e.selectedSearchPollutants,g.resultNodes=e.resultNodes,g.signOut=function(){f.authenticate(null),b.go("main.authentication"),c.memo("authentication")}}]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers").controller("authenticationController",["$scope","$state","$previousState","authenticationService",function(a,b,c,d){"use strict";this.signIn=function(){d.authenticate({name:"Test User",roles:["User"]}),c.get("authentication")&&c.get("authentication").state&&"main.authentication"!==c.get("authentication").state.name?c.go("authentication"):b.go("main.search.map")}}]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers").controller("entityController",["$scope","$state","$stateParams","$previousState","$uibModalInstance","entity","entityModalInvoker",function(a,b,c,d,e,f,g){"use strict";a["class"]=c["class"],a.id=c.id,a.entity=f,console.log("entityController created"),e.result["finally"](function(){console.log(d.get("entityModalInvoker").state),d.get("entityModalInvoker")&&d.get("entityModalInvoker").state?(console.log("entityController::close goto $previousState "+d.get("entityModalInvoker").state.name),d.go("entityModalInvoker")):(console.log("entityController::close goto default main.search.map"),b.go("main.search.map"))}),a.close=function(){console.log("entityController::close"),e.dismiss("close")},a.$on("$stateChangeStart",function(a,b){b.$$state().includes["modal.entity"]?console.log("entityController::$stateChangeStart: ignore "+b):(console.log("entityController::$stateChangeStart: $uibModalInstance.close"),e.dismiss("close"))})}]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers").controller("listController",["$scope","configurationService","sharedDatamodel","NgTableParams",function(a,b,c,d){"use strict";var e,f;e=this,e.mode=a.mainController.mode,"search"===e.mode?e.nodes=c.resultNodes:"analysis"===e.mode&&(e.nodes=c.analysisNodes),e.tableColumns=[{field:"classKey",title:"Thema",show:!1,groupable:"classKey"},{field:"name",title:"Name",sortable:"name",show:!0},{field:"description",title:"Beschreibung",show:!0}],f={sorting:{name:"asc"},count:10},e.tableData=new d(f,{dataset:e.nodes,counts:[]}),a.$on("searchSuccess()",function(a){e.tableData.reload()}),a.$parent.listController=e,console.log("new listController instance created from "+a.name)}]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers").controller("mainController",["$scope","$state","$previousState","sharedDatamodel",function(a,b,c,d){"use strict";var e;e=this,console.log("mainController::main instance created"),e.mode=b.current.name.split(".").slice(1,2).pop(),a.$on("$stateChangeSuccess",function(a){if(b.includes("main")&&!b.is("main")){e.mode=b.current.name.split(".").slice(1,2).pop(),console.log("mainController::mainController.mode: "+e.mode);var d=c.get();d&&d.state&&d.state.name?e.previousStateName=d.state.name:e.previousStateName=void 0}else console.log("mainController::ingoring stateChange '"+b.name+"'")})}]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers").controller("mapController",["$scope","$state","$stateParams","leafletData","configurationService","sharedDatamodel","featureRendererService",function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;j=this,j.mode=a.mainController.mode,i=j.mode+"-map",k=e.map,m=new L.FeatureGroup,w=null,"search"===j.mode?j.nodes=f.resultNodes:"analysis"===j.mode&&(j.nodes=f.analysisNodes),o=angular.copy(k.defaults),p=angular.copy(k.maxBounds),u=angular.copy(k.maxBounds),q=angular.copy(k.basemaps),r=angular.copy(k.overlays),s=angular.copy(k.layerControlOptions),t=angular.copy(k.drawOptions),angular.extend(a,{layers:{},defaults:o,center:p,maxBounds:u,controls:{scale:!0},tileLayer:""}),r=angular.extend(k.overlays,{},[{groupName:"Aktueller Ort",expanded:!0,layers:{}},{groupName:"Themen",expanded:!0,layers:{}}]),l=L.Control.styledLayerControl(q,r,s),n=new L.Control.Draw({draw:t,edit:!1,remove:!1}),d.getMap(i).then(function(a){h=a,a.addLayer(m),a.addControl(n),a.addControl(l),a.setMaxBounds(u),a.setZoom(p.zoom),l.selectLayer(q[0].layers[k.defaultLayer]),a.on("draw:created",function(a){v(a.layer,a.layerType)}),a.on("draw:deleted",function(a){v(null)}),a.on("layerremove",function(a){var b=a.layer;b&&b===w&&console.log("mapController::gazetteerLocationLayer removed")})}),v=function(a,b){m.clearLayers(),null!==a&&(m.addLayer(a),k.options.centerOnSearchGeometry&&d.getMap(i).then(function(a){a.fitBounds(m.getBounds(),{animate:!0,pan:{animate:!0,duration:.6},zoom:{animate:!0},maxZoom:k.options.preserveZoomOnCenter?a.getZoom():null})}),a.once("click",function(a){v(null)}))},j.gotoNode=function(a){a.feature&&h.setView(a.feature.getLatLng(),14)},j.setNodes=function(a){var b,c,d;if(null!==a&&a.length>0){b=g.createNodeFeatureLayers(a);for(c in b)console.log("mapController::setResultNodes for "+c),d=b[c],l.addOverlay(d,d.name,{groupName:"Themen"})}(j.nodes!==a||j.nodes!==f.resultNodes||f.resultNodes!==a)&&console.error("mapController::nodes reference (t)error!")},j.setGazetteerLocation=function(a){console.log("mapController::setGazetteerLocation"),null!==a?(null!==w&&(l.removeLayer(w),w=null),w=g.createGazetteerLocationLayer(a),null!==w?(w.StyledLayerControl={removable:!1,visible:!1},l.addOverlay(w,a.name,{groupName:"Aktueller Ort"}),l.selectLayer(w),d.getMap(i).then(function(a){a.fitBounds(w.getBounds(),{animate:!0,pan:{animate:!0,duration:.6},zoom:{animate:!0},maxZoom:null})})):j.setGazetteerLocation(null)):null!==w&&(l.removeLayer(w),w=null)},console.log(a.mainController.mode+" map controller instance created"),a.$on("gotoLocation()",function(a){"search"===j.mode&&(console.log("mapController::gotoLocation("+f.selectedGazetteerLocation.name+")"),j.setGazetteerLocation(f.selectedGazetteerLocation))}),a.$on("searchSuccess()",function(a){"search"===j.mode&&f.resultNodes.length>0?j.setNodes(f.resultNodes):"analysis"===j.mode&&f.analysisNodes.length>0&&j.setNodes(f.resultNodes)}),a.$watch(function(){return j.zoom},function(a,b){j.zoom&&a!==b}),a.$parent.mapController=j}]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers").controller("searchController",["$window","$timeout","$scope","$state","leafletData","configurationService","sharedDatamodel","dataService",function(a,b,c,d,e,f,g,h){"use strict";var i;i=this,i.searchThemes=h.getSearchThemes(),i.selectedSearchThemes=g.selectedSearchThemes,i.searchThemesSettings=angular.extend({},f.multiselect.settings,{smartButtonMaxItems:0,smartButtonTextConverter:function(a,b){return 1===i.selectedSearchThemes.length?"1 Thema ausgewählt":""}}),i.searchThemesTranslationTexts=angular.extend({},f.multiselect.translationTexts,{buttonDefaultText:"Themen auswählen",dynamicButtonTextSuffix:"Themen ausgewählt"}),h.getSearchPollutants().$resolved?i.searchPollutants=h.getSearchPollutants():h.getSearchPollutants().$promise.then(function(a){i.searchPollutants=a}),i.selectedSearchPollutants=g.selectedSearchPollutants,i.searchPollutantsSettings=angular.extend({},f.multiselect.settings,{scrollableHeight:"600px",scrollable:!0,displayProp:"pollutant_name",idProp:"pollutant_key",searchField:"pollutant_name",enableSearch:!0,showEnableSearchButton:!1,selectByGroups:["Metalle und Schwermetalle"]}),i.searchPollutantsTranslationTexts=angular.extend({},f.multiselect.translationTexts,{buttonDefaultText:"Schadstoffe auswählen",dynamicButtonTextSuffix:"Schadstoffe ausgewählt"}),h.getGazetteerLocations().$resolved?i.gazetteerLocations=h.getGazetteerLocations():h.getGazetteerLocations().$promise.then(function(a){i.gazetteerLocations=a}),i.selectedGazetteerLocation=g.selectedGazetteerLocation,i.gazetteerLocationsSettings=angular.extend({},f.multiselect.settings,{styleActive:!1,closeOnSelect:!0,scrollableHeight:"600px",scrollable:!0,displayProp:"name",idProp:"$self",searchField:"name",enableSearch:!0,smartButtonMaxItems:1,selectionLimit:1,externalIdProp:""}),i.gazetteerLocationsTranslationTexts=angular.extend({},f.multiselect.translationTexts,{buttonDefaultText:"Ort auswählen"}),console.log("searchController instance created"),i.mode="map",i.gotoLocation=function(){"map"!==i.mode&&d.go("^.map"),c.$broadcast("gotoLocation()")},i.search=function(a){if(a||(a=h.getMockNodes()),a.$resolved){var b;g.resultNodes.length=0,b=angular.copy(a.slice(0,20)),g.resultNodes.push.apply(g.resultNodes,b),g.analysisNodes.length=0,b=angular.copy(a.slice(5,15)),g.analysisNodes.push.apply(g.analysisNodes,b),c.$broadcast("searchSuccess()")}else a.$promise.then(function(a){i.search(a)})},c.$on("$stateChangeSuccess",function(a){d.includes("main.search")&&!d.is("main.search")&&(i.mode=d.current.name.split(".").slice(1,3).pop(),"map"===i.mode&&e.getMap("search-map").then(function(a){b(function(){a&&a._container.parentElement&&(a._container.parentElement.offsetHeight>0&&a._container.parentElement.offsetWidth?(c.mapHeight=a._container.parentElement.offsetHeight,c.mapWidth=a._container.parentElement.offsetWidth,a.invalidateSize(!1)):a.invalidateSize(!1))},100)}))})}]),angular.module("de.cismet.uim2020-html5-demonstrator.directives",[]),angular.module("de.cismet.uim2020-html5-demonstrator.directives").directive("ngSize",["$rootScope",function(a){"use strict";return{restrict:"A",controller:["$scope",function(a){a.size={}}],link:function(b,c){var d,e;a.ngSizeDimensions=angular.isArray(a.ngSizeDimensions)?a.ngSizeDimensions:[],a.ngSizeWatch=angular.isArray(a.ngSizeWatch)?a.ngSizeWatch:[],d=function(){angular.forEach(a.ngSizeWatch,function(b,c){(a.ngSizeDimensions[c][0]!==b.offsetWidth||a.ngSizeDimensions[c][1]!==b.offsetHeight)&&(a.ngSizeDimensions[c]=[b.offsetWidth,b.offsetHeight],a.$broadcast("size::changed",c))})},e=!1,angular.forEach(a.ngSizeWatch,function(a,b){a===c[0]&&(e=b)}),e===!1&&(a.ngSizeWatch.push(c[0]),a.ngSizeDimensions.push([c[0].offsetWidth,c[0].offsetHeight]),e=a.ngSizeWatch.length-1),b.$on("size::changed",function(c,d){d===e&&(b.size||(b.size={}),b.size.width=a.ngSizeDimensions[d][0],b.size.height=a.ngSizeDimensions[d][1],console.log("width: "+b.size.width),console.log("height: "+b.size.height))}),window.ngSizeHandler||(window.ngSizeHandler=setInterval(d,10)),angular.element(window).on("resize",d)}}}]),angular.module("de.cismet.uim2020-html5-demonstrator.filters",[]),angular.module("de.cismet.uim2020-html5-demonstrator.services",["ngResource"]),angular.module("de.cismet.uim2020-html5-demonstrator.services").factory("authenticationService",["$q","$http","$timeout",function(a,b,c){"use strict";var d,e=!1;return{isIdentityResolved:function(){return angular.isDefined(d)},isAuthenticated:function(){return e},isInRole:function(a){return e&&d.roles?-1!==d.roles.indexOf(a):!1},isInAnyRole:function(a){if(!e||!d.roles)return!1;for(var b=0;b<a.length;b++)if(this.isInRole(a[b]))return!0;return!1},authenticate:function(a){d=a,e=null!==a,a?localStorage.setItem("de.cismet.uim2020-html5-demonstrator.identity",angular.toJson(a)):localStorage.removeItem("de.cismet.uim2020-html5-demonstrator.identity")},getIdentity:function(a){if(a===!0)return d=void 0,e=!1,d;var b=localStorage.getItem("de.cismet.uim2020-html5-demonstrator.identity");return b&&(d=angular.fromJson(b),e=!0),d}}}]),angular.module("de.cismet.uim2020-html5-demonstrator.services").factory("autorisationService",["$rootScope","$state","$previousState","authenticationService",function(a,b,c,d){"use strict";return{authorize:function(){return d.identity().then(function(){var e=d.isAuthenticated();a.toState.data.roles&&a.toState.data.roles.length>0&&!d.isInAnyRole(a.toState.data.roles)&&(e?(console.warn("user is not in any role"),c.memo("autorisation")):(c.memo("autorisation"),b.go("signin")))})}}}]),angular.module("de.cismet.uim2020-html5-demonstrator.services").service("configurationService",[function(){"use strict";var a,b,c;this.cidsRestApi={},this.cidsRestApi.host="http://localhost:8890",this.searchService={},this.searchService.username="admin@SWITCHON",this.searchService.password="cismet",this.searchService.defautLimit=10,this.searchService.maxLimit=50,this.searchService.host=this.cidsRestApi.host,this.map={},this.map.options={},this.map.options.centerOnSearchGeometry=!0,this.map.options.preserveZoomOnCenter=!0,this.map.home={},this.map.home.lat=47.61,this.map.home.lng=13.782778,this.map.home.zoom=7,this.map.maxBounds=new L.latLngBounds(L.latLng(46.372299,9.53079),L.latLng(49.02071,17.160749)),this.map.defaults={minZoom:7,maxBounds:this.map.maxBounds,controls:{layers:{visible:!1,position:"bottomright",collapsed:!0}}},this.map.layerControlOptions={container_width:"300px",container_height:"600px",container_maxHeight:"600px",exclusive:!1},this.map.defaultLayer="Verwaltungsgrundkarte",a=new L.tileLayer("http://{s}.wien.gv.at/basemap/geolandbasemap/normal/google3857/{z}/{y}/{x}.png",{subdomains:["maps","maps1","maps2","maps3","maps4"],attribution:'&copy; <a href="http://basemap.at">Basemap.at</a>, <a href="http://www.isticktoit.net">isticktoit.net</a>'}),a.name="Verwaltungsgrundkarte",a.key="basemap.at",b=L.esri.basemapLayer("Topographic"),b.name="ArcGIS Topographic",b.key="arcgisonline.com",c=new L.TileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{id:"mainmap",attribution:'Map data © <a href="http://openstreetmap.org" target="_blank">OpenStreetMap</a> contributors'}),c.name="OpenStreetMap",c.key="openstreetmap.org",this.map.basemaps=[{groupName:"Grundkarten",expanded:!0,layers:{Verwaltungsgrundkarte:a,"ArcGIS Topographic":b,OpenStreetMap:c}}],this.map.overlays=[],this.map.drawOptions={polyline:!1,polygon:{shapeOptions:{color:"#800000",clickable:!0},showArea:!0,metric:!0},rectangle:{shapeOptions:{color:"#800000",clickable:!0},metric:!0},circle:!1,marker:!1},this.featureRenderer={},this.featureRenderer.defaultStyle={color:"#0000FF",fill:!1,weight:2,riseOnHover:!0,clickable:!1},this.featureRenderer.highlightStyle={fillOpacity:.4,fill:!0,fillColor:"#1589FF",riseOnHover:!0,clickable:!1},this.featureRenderer.icons={},this.featureRenderer.icons.BORIS_SITE=L.icon({iconUrl:"icons/showel_16.png",iconSize:[16,16]}),this.featureRenderer.icons.WAGW_STATION=L.icon({iconUrl:"icons/wagw_16.png",iconSize:[16,16]}),this.featureRenderer.icons.WAOW_STATION=L.icon({iconUrl:"icons/waow_16",iconSize:[16,16]}),this.featureRenderer.icons.EPRTR_INSTALLATION=L.icon({iconUrl:"icons/factory_16.png",iconSize:[16,16]}),this.featureRenderer.icons.MOSS=L.icon({iconUrl:"icons/grass_16.png",iconSize:[16,16]}),this.featureRenderer.layergroupNames={},this.featureRenderer.layergroupNames.MOSS="Moose",this.featureRenderer.layergroupNames.EPRTR_INSTALLATION="ePRTR ePRTR Einrichtungen",this.featureRenderer.layergroupNames.WAOW_STATION="Wassermesstellen",this.featureRenderer.layergroupNames.WAGW_STATION="Grundwassermesstellen",this.featureRenderer.layergroupNames.BORIS_SITE="Bodenmesstellen",this.multiselect={},this.multiselect.settings={styleActive:!0,displayProp:"name",idProp:"classId",buttonClasses:"btn btn-default navbar-btn cs-search-multiselect"},this.multiselect.translationTexts={checkAll:"Alles auswählen",uncheckAll:"Alles abwählen",enableSearch:"Suche aktivieren",disableSearch:"Suche deaktivieren",selectionCount:" ausgewählt",selectionOf:" von ",searchPlaceholder:"Suche...",buttonDefaultText:"Auswählen",dynamicButtonTextSuffix:"ausgewählt",selectGroup:"Alle auswählen: "}}]),angular.module("de.cismet.uim2020-html5-demonstrator.services").factory("dataService",["$resource",function(a){"use strict";var b,c,d,e;return b={searchThemes:"data/searchThemes.json",searchPollutants:"data/searchPollutants.json",gazetteerLocations:"data/gazetteerLocations.json",filterPollutants:"data/filterPollutants.json",mockNodes:"data/resultNodes.json",mockObjects:"data/resultObjects.json"},c=[],d=function(d,e){var f;return c.hasOwnProperty(d)?(f=c[d],f.$resolved||console.warn("possible synchonisation problem for cached resource "+d),f):b.hasOwnProperty(d)?(f=a(b[d],{},{query:{method:"GET",params:{},isArray:e}}),c[d]=f.query(),c[d]):(console.warn("unknown static resource:"+d),null)},e=function(a){for(var b,c,d=a.length;d;)c=Math.floor(Math.random()*d--),b=a[d],a[d]=a[c],a[c]=b;return a},{getSearchThemes:function(){return d("searchThemes",!0)},getSearchPollutants:function(){return d("searchPollutants",!0)},getGazetteerLocations:function(){return d("gazetteerLocations",!0)},getMockNodes:function(){var a=d("mockNodes",!0);return a.$resolved&&e(a),a}}}]),angular.module("de.cismet.uim2020-html5-demonstrator.services").factory("featureRendererService",["configurationService",function(a){"use strict";var b,c,d,e,f,g,h;return b=a.featureRenderer,g=function(a){var b,c,d,e;if(a.hasOwnProperty("area"))b=a.area.geo_field,d=!1;else{if(!a.hasOwnProperty("geometry"))return null;b=a.geometry.geo_field,d=!0}return c=new Wkt.Wkt,c.read(b.substr(b.indexOf(";")+1)),e=d===!0?c.toObject().getLayers()[0]:c.toObject(),e.name=a.name,e.key="gazetteerLocation",e},d=function(a,c){if(a.hasOwnProperty("geometry")){var d,e,f;d=a.geometry,e=new Wkt.Wkt,e.read(d.substr(d.indexOf(";")+1));var g={icon:b.icons[c],title:a.name};return f=e.toObject(g),f.name=a.name,f.key=a.$self,a.feature=f,f}},h=function(a){var c,e,f,g,h,i;for(i={},c=0;c<a.length;++c)e=a[c],f=e.classKey.split(".").slice(1,2).pop(),h=d(e,f),h&&(i.hasOwnProperty(f)?g=i[f]:(g=new L.FeatureGroup,g.name=b.layergroupNames[f],g.key=f,g.StyledLayerControl={removable:!1,visible:!1},i[f]=g),h.addTo(g));return i},c=function(a){var b,c,d,f;return d=null,!d&&a.spatialcoverage&&a.spatialcoverage.geo_field&&(b=a.spatialcoverage.geo_field,c=new Wkt.Wkt,c.read(b.substr(b.indexOf(";")+1)),f=Object.create(e),a.name&&(f.title=a.name),d=c.toObject(f),d.setStyle(e)),a&&a.$self&&"/switchon.resource"===a.$self.substr(0,18).toLowerCase()&&a.representation&&a.representation.every(function(e){var f,g;return e.name&&e.contentlocation&&e.type&&"aggregated data"===e.type.name&&e["function"]&&"service"===e["function"].name&&e.protocol&&("WWW:TILESERVER"===e.protocol.name?(d=L.tileLayer(e.contentlocation,{tms:"true",zIndex:999}),d.getBounds=function(){return a.spatialcoverage&&a.spatialcoverage.geo_field?(b=a.spatialcoverage.geo_field,c=new Wkt.Wkt,c.read(b.substr(b.indexOf(";")+1)),c.toObject().getBounds()):void 0},d.setOpacity(0)):"OGC:WMS-1.1.1-http-get-capabilities"===e.protocol.name&&(f=e.contentlocation,g=e.name,d=L.tileLayer.wms(f,{layers:g,format:"image/png",transparent:!0,version:"1.1.1",zIndex:999}),d.getBounds=function(){return a.spatialcoverage&&a.spatialcoverage.geo_field?(b=a.spatialcoverage.geo_field,c=new Wkt.Wkt,c.read(b.substr(b.indexOf(";")+1)),c.toObject().getBounds()):void 0},d.setOpacity(0))),null===d}),d},{createNodeFeatureLayers:h,createGazetteerLocationLayer:g,defaultStyle:e,highlightStyle:f}}]),angular.module("de.cismet.uim2020-html5-demonstrator.services").factory("geoTools",["leafletData",function(a){"use strict";var b,c,d,e,f,g,h;return b=new Wkt.Wkt,c={color:"#0000FF",fillOpacity:.3,weight:2,fill:!0,fillColor:"#1589FF",riseOnHover:!0,clickable:!0},e={polyline:!1,polygon:{shapeOptions:c,showArea:!0,metric:!0,allowIntersection:!1,drawError:{color:"#e1e100",message:"<strong>Oh snap!<strong> you can't draw that!</strong>"}},rectangle:{shapeOptions:c,metric:!0},circle:!1,marker:!1},d={polyline:!1,polygon:!1,rectangle:!1,circle:!1,marker:!1},f=function(a){if(a.spatialcoverage&&a.spatialcoverage.geo_field){var d=a.spatialcoverage.geo_field;-1!==d.indexOf(";")?b.read(d.substr(d.indexOf(";")+1)):b.read(d);var e=b.toObject(c);return e.setStyle(c),e}return void 0},g=function(a,b){if(b&&a.spatialcoverage){var c="SRID=4326;"+b;a.spatialcoverage.geo_field=c}},h=function(b){a.getMap(b).then(function(a){setTimeout(function(){a.invalidateSize()},50)})},{wicket:b,defaultStyle:c,defaultDrawOptions:e,noDrawOptions:d,readSpatialCoverage:f,writeSpatialCoverage:g,fireResize:h}}]),angular.module("de.cismet.uim2020-html5-demonstrator.services").factory("objectRendererService",["configurationService",function(a){"use strict";var b;return b=function(a){return a},{getObjectIcon:b}}]),angular.module("de.cismet.uim2020-html5-demonstrator.services").service("sharedDatamodel",[function(){"use strict";this.selectedSearchThemes=[],this.selectedSearchPollutants=[],this.selectedGazetteerLocation={},this.selectedSearchGeometry={},this.resultNodes=[],this.analysisNodes=[]}]);
//# sourceMappingURL=uim2020-html5-demonstrator.min.js.map