var app=angular.module("de.cismet.uim2020-html5-demonstrator",["ngResource","ngAnimate","ngSanitize","ui.bootstrap","ui.bootstrap.tpls","ui.router","ct.ui.router.extras.sticky","ct.ui.router.extras.dsr","ct.ui.router.extras.previous","leaflet-directive","ngTable","mgo-angular-wizard","de.cismet.uim2020-html5-demonstrator.controllers","de.cismet.uim2020-html5-demonstrator.directives","de.cismet.uim2020-html5-demonstrator.services","de.cismet.uim2020-html5-demonstrator.filters","de.cismet.uim2020-html5-demonstrator.factories"]);app.config(["$logProvider","$stateProvider","$urlRouterProvider",function(a,b,c){"use strict";a.debugEnabled(!1),c.otherwise("/search/map"),b.state("main",{"abstract":!0,url:"",views:{"main@":{templateUrl:"views/main.html",controller:["$scope",function(a){console.log("main instance created"),a.name="main",this.name="this.main"}],controllerAs:"mainVm"}}}),b.state("main.authentication",{url:"/login",data:{roles:["User"]},views:{"authentication@main":{templateUrl:"views/authentication/login.html",controller:"authenticationController",controllerAs:"authenticationController"}}}),b.state("main.search",{url:"/search",data:{roles:["User"]},sticky:!0,deepStateRedirect:{"default":{state:"main.search.map",params:{zoom:"15"}}},views:{"search@main":{templateUrl:"views/search/index.html",controller:["$scope",function(a){console.log("main.search instance created"),a.name="main.search",this.name="this.main.search"}],controllerAs:"searchVm"},"search-toolbar@main.search":{templateUrl:"views/search/toolbar.html",controller:["$scope",function(a){console.log("main.search.toolbar instance created"),a.name="main.search.toolbar",this.name="this.main.search.toolbar"}],controllerAs:"toolbarVm"}}}),b.state("main.search.map",{url:"/map?{center:int}&{zoom:int}",data:{roles:["User"]},sticky:!0,views:{"search-map@main.search":{templateUrl:"views/search/map.html",controller:"mapController",controllerAs:"mapVm"}}}),b.state("main.search.list",{url:"/list",data:{roles:["User"]},sticky:!0,views:{"search-list@main.search":{templateUrl:"views/search/list.html",controller:"listController",controllerAs:"listVm"}}}),b.state("main.analysis",{url:"/analysis",data:{roles:["User"]},sticky:!0,deepStateRedirect:{"default":{state:"main.analysis.map",params:{zoom:"14"}}},views:{"analysis@main":{templateUrl:"views/analysis/index.html",controller:["$scope",function(a){console.log("main.analysis instance created"),a.name="main.analysis",this.name="this.main.analysis"}],controllerAs:"analysisVm"},"analysis-toolbar@main.analysis":{templateUrl:"views/analysis/toolbar.html",controller:["$scope",function(a){console.log("main.analysis.toolbar instance created"),a.name="main.analysis.toolbar",this.name="this.main.analysis.toolbar"}],controllerAs:"toolbarVm"}}}),b.state("main.analysis.map",{url:"/map?{center:int}&{zoom:int}",data:{roles:["User"]},views:{"analysis-map@main.analysis":{templateUrl:"views/analysis/map.html",controller:["$scope","$stateParams","$state",function(a,b,c){console.log("main.analysis.map instance created"),a.name="main.analysis.map";var d=this;this.name="this.main.analysis.map",this.center=b.center,this.zoom=b.zoom,a.$watch(function(){return d.zoom},function(a,b){d.zoom&&a!==b&&c.go("main.analysis.map",{zoom:d.zoom},{inherit:!0,notify:!1,reload:!1}).then(function(a){console.log(a)})})}],controllerAs:"mapVm"}},onEnter:function(){console.log("enter main.analysis.map")},onExit:function(){console.log("exit main.analysis.map")}}),b.state("main.analysis.list",{url:"/list",data:{roles:["User"]},views:{"analysis-list@main.analysis":{templateUrl:"views/analysis/list.html",controller:["$scope",function(a){console.log("main.analysis.list instance created"),a.name="main.analysis.list",this.name="this.main.analysis.list"}],controllerAs:"listVm"}}}),b.state("main.protocol",{url:"/protocol",data:{roles:["User"]},sticky:!0,templateUrl:"views/protocol/index.html"})}]),app.run(["$rootScope","$state","$stateParams","$previousState","authenticationService",function(a,b,c,d,e){"use strict";a.$state=b,a.$stateParams=c,a.$on("$stateChangeError",console.log.bind(console)),a.$on("$stateChangeStart",function(a,c,f,g,h){"main.authentication"!==c.name?(e.isIdentityResolved()||e.getIdentity())&&e.isAuthenticated()||(console.warn("user not logged in!"),a.preventDefault(),d.memo("authentication"),b.go("main.authentication")):d.memo("authentication")})}]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers",[]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers").controller("authenticationController",["$scope","$state","$previousState","authenticationService",function(a,b,c,d){"use strict";this.signIn=function(){d.authenticate({name:"Test User",roles:["User"]}),c.get("authentication")&&c.get("authentication").state&&"main.authentication"!==c.get("authentication").state.name?c.go("authentication"):b.go("main.search.map")}}]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers").controller("listController",["$scope","NgTableParams",function(a,b){"use strict";var c=this,d=[{name:"Moroni",age:50}];c.tableParams=new b({},{dataset:d}),console.log("new listController instance created from "+a.name)}]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers").controller("mapController",["$scope",function(a){"use strict";console.log("new mapController instance created from "+a.name)}]),angular.module("de.cismet.uim2020-html5-demonstrator.controllers").controller("masterController",["$scope","$state","$previousState","appConfig","authenticationService","leafletData","geoTools",function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s;h=this,h.config=d,l=g.wicket,m=g.defaultStyle,n=g.defaultDrawOptions,o=g.noDrawOptions,q=g.readSpatialCoverage,p=g.writeSpatialCoverage,i=g.fireResize,a.mapData={},a.mapData.center=h.config.mapView.home,a.mapData.defaults={tileLayer:h.config.mapView.backgroundLayer,attributionControl:!0,minZoom:h.config.minZoom,path:m},k=new L.FeatureGroup,j=new L.Control.Draw({draw:n,edit:{featureGroup:k}}),r=!0,h.signOut=function(){e.authenticate(null),b.go("main.authentication"),c.memo("authentication")},f.getMap("mainmap").then(function(a){a.addLayer(k),a.addControl(j),a.on("draw:created",function(a){k.clearLayers(),k.addLayer(a.layer)}),a.on("draw:edited",function(){}),a.on("draw:deleted",function(a){console.log(a.layers.getLayers().length+" deleted"),k.clearLayers()})});var t="https://api.mapbox.com/styles/v1/mapbox/streets-v9/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY3dtIiwiYSI6InFoYkpvS00ifQ.WHqQ_q865NKjIQB6Wpoi2w",u='© <a href="https://www.mapbox.com/map-feedback/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',v={attribution:u},w=L.tileLayer(t,v),x=L.tileLayer("http://{s}.tile.stamen.com/watercolor/{z}/{x}/{y}.jpg",{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'});f.getMap("mainmap").then(function(b){a.map=b});var y={DRAW:k},z=L.control.layers({"ESRI StreetMap":x,OpenTopoMap:w},y);f.getMap("mainmap").then(function(a){z.addTo(a)}),f.getMap("mainmap").then(function(a){a.setView([42.09618442380296,-71.5045166015625],8);L.tileLayer("http://{s}.tile.stamen.com/watercolor/{z}/{x}/{y}.jpg",{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>'}).addTo(a);s=new L.Shapefile("bower_components/leaflet-shapefile/congress.zip",{onEachFeature:function(a,b){a.properties&&b.bindPopup(Object.keys(a.properties).map(function(b){return b+": "+a.properties[b]}).join("<br />uiui"),{maxHeight:200})}}),s.addTo(a),s.once("data:loaded",function(){})})}]),angular.module("de.cismet.uim2020-html5-demonstrator.directives",[]),angular.module("de.cismet.uim2020-html5-demonstrator.directives").directive("myDirective",[function(){"use strict";return{restrict:"E",templateUrl:"templates/my-directive.html",scope:{},controller:"myDirectiveController"}}]),angular.module("de.cismet.uim2020-html5-demonstrator.factories",[]),angular.module("de.cismet.uim2020-html5-demonstrator.factories").factory("appConfig",[function(){"use strict";var a={};return a.cidsRestApi={},a.cidsRestApi.host="http://localhost:8890",a.searchService={},a.searchService.username="admin@SWITCHON",a.searchService.password="cismet",a.searchService.defautLimit=10,a.searchService.maxLimit=50,a.searchService.host=a.cidsRestApi.host,a.mapView={},a.mapView.backgroundLayer="https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",a.mapView.home={},a.mapView.home.lat=49.245166,a.mapView.home.lng=6.936809,a.mapView.home.zoom=4,a.mapView.maxBounds={},a.mapView.maxBounds.southWest=[90,-180],a.mapView.maxBounds.northEast=[-90,180],a.mapView.minZoom=2,a.gui={},a.gui.dev=!1,a.objectInfo={},a.objectInfo.resourceJsonUrl="http://"+a.searchService.username+":"+a.searchService.password+"@"+a.searchService.host.replace(/.*?:\/\//g,""),a.objectInfo.resourceXmlUrl="http://tl-243.xtr.deltares.nl/csw?request=GetRecordById&service=CSW&version=2.0.2&namespace=xmlns%28csw=http://www.opengis.net/cat/csw/2.0.2%29&resultType=results&outputSchema=http://www.isotc211.org/2005/gmd&outputFormat=application/xml&ElementSetName=full&id=",a.byod={},a.byod.baseUrl="http://switchon.cismet.de/sip-snapshot",a.uploadtool={},a.uploadtool.baseUrl="http://dl-ng003.xtr.deltares.nl",a}]),angular.module("de.cismet.uim2020-html5-demonstrator.filters",[]),angular.module("de.cismet.uim2020-html5-demonstrator.services",["ngResource"]),angular.module("de.cismet.uim2020-html5-demonstrator.services").factory("authenticationService",["$q","$http","$timeout",function(a,b,c){"use strict";var d,e=!1;return{isIdentityResolved:function(){return angular.isDefined(d)},isAuthenticated:function(){return e},isInRole:function(a){return e&&d.roles?-1!==d.roles.indexOf(a):!1},isInAnyRole:function(a){if(!e||!d.roles)return!1;for(var b=0;b<a.length;b++)if(this.isInRole(a[b]))return!0;return!1},authenticate:function(a){d=a,e=null!==a,a?localStorage.setItem("de.cismet.uim2020-html5-demonstrator.identity",angular.toJson(a)):localStorage.removeItem("de.cismet.uim2020-html5-demonstrator.identity")},getIdentity:function(a){if(a===!0)return d=void 0,e=!1,d;var b=localStorage.getItem("de.cismet.uim2020-html5-demonstrator.identity");return b&&(d=angular.fromJson(b),e=!0),d}}}]),angular.module("de.cismet.uim2020-html5-demonstrator.services").factory("autorisationService",["$rootScope","$state","$previousState","authenticationService",function(a,b,c,d){"use strict";return{authorize:function(){return d.identity().then(function(){var e=d.isAuthenticated();a.toState.data.roles&&a.toState.data.roles.length>0&&!d.isInAnyRole(a.toState.data.roles)&&(e?(console.warn("user is not in any role"),c.memo("autorisation")):(c.memo("autorisation"),b.go("signin")))})}}}]),angular.module("de.cismet.uim2020-html5-demonstrator.services").factory("configurationService",[function(){"use strict";var a={};return a.cidsRestApi={},a.cidsRestApi.host="http://localhost:8890",a.searchService={},a.searchService.username="admin@SWITCHON",a.searchService.password="cismet",a.searchService.defautLimit=10,a.searchService.maxLimit=50,a.searchService.host=a.cidsRestApi.host,a.mapView={},a.mapView.backgroundLayer="https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",a.mapView.home={},a.mapView.home.lat=49.245166,a.mapView.home.lng=6.936809,a.mapView.home.zoom=4,a.mapView.maxBounds={},a.mapView.maxBounds.southWest=[90,-180],a.mapView.maxBounds.northEast=[-90,180],a.mapView.minZoom=2,a.gui={},a.gui.dev=!1,a.objectInfo={},a.objectInfo.resourceJsonUrl="http://"+a.searchService.username+":"+a.searchService.password+"@"+a.searchService.host.replace(/.*?:\/\//g,""),a.objectInfo.resourceXmlUrl="http://tl-243.xtr.deltares.nl/csw?request=GetRecordById&service=CSW&version=2.0.2&namespace=xmlns%28csw=http://www.opengis.net/cat/csw/2.0.2%29&resultType=results&outputSchema=http://www.isotc211.org/2005/gmd&outputFormat=application/xml&ElementSetName=full&id=",a.byod={},a.byod.baseUrl="http://switchon.cismet.de/sip-snapshot",a.uploadtool={},a.uploadtool.baseUrl="http://dl-ng003.xtr.deltares.nl",a}]),angular.module("de.cismet.uim2020-html5-demonstrator.services").factory("geoTools",["leafletData",function(a){"use strict";var b,c,d,e,f,g,h;return b=new Wkt.Wkt,c={color:"#0000FF",fillOpacity:.3,weight:2,fill:!0,fillColor:"#1589FF",riseOnHover:!0,clickable:!0},e={polyline:!1,polygon:{shapeOptions:c,showArea:!0,metric:!0,allowIntersection:!1,drawError:{color:"#e1e100",message:"<strong>Oh snap!<strong> you can't draw that!</strong>"}},rectangle:{shapeOptions:c,metric:!0},circle:!1,marker:!1},d={polyline:!1,polygon:!1,rectangle:!1,circle:!1,marker:!1},f=function(a){if(a.spatialcoverage&&a.spatialcoverage.geo_field){var d=a.spatialcoverage.geo_field;-1!==d.indexOf(";")?b.read(d.substr(d.indexOf(";")+1)):b.read(d);var e=b.toObject(c);return e.setStyle(c),e}return void 0},g=function(a,b){if(b&&a.spatialcoverage){var c="SRID=4326;"+b;a.spatialcoverage.geo_field=c}},h=function(b){a.getMap(b).then(function(a){setTimeout(function(){a.invalidateSize()},50)})},{wicket:b,defaultStyle:c,defaultDrawOptions:e,noDrawOptions:d,readSpatialCoverage:f,writeSpatialCoverage:g,fireResize:h}}]),angular.module("").run(["$templateCache",function(a){"use strict";a.put("templates/my-directive.html","<div>The 'templates' folder contains template htmls of directives that will automagically be processed during build.<br>The 'scripts/directives' folder contains the actual directives that will automagically be processed during build.<br>{{description}}<br>{{info}}</div>")}]);
//# sourceMappingURL=uim2020-html5-demonstrator.min.js.map